<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BrandOrb | Intelligence Dashboard</title>
    <style>
        body, html { margin: 0; padding: 0; height: 100%; width: 100%; overflow: hidden; font-family: 'Inter', sans-serif; background: #0f172a; }
        #app-container { display: flex; width: 100vw; height: 100vh; background: #f8fafc; visibility: hidden; }
        #sidebar { width: 260px; background: #0f172a; flex-shrink: 0; color: white; display: flex; flex-direction: column; }
        #main-content { flex-grow: 1; display: flex; flex-direction: column; overflow-y: auto; width: 100%; }
        #login-overlay { position: fixed; inset: 0; background: #0f172a; display: flex; align-items: center; justify-content: center; z-index: 9999; }
        .login-card { background: white; padding: 40px; border-radius: 12px; width: 360px; text-align: center; }
        #map-element { width: 100%; height: 600px; background: #eee; margin-top: 20px; }
    </style>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>

    <div id="login-overlay">
        <div class="login-card">
            <div id="logo-drop-zone" onclick="document.getElementById('logo-upload').click()" style="border: 2px dashed #ccc; padding: 20px; cursor: pointer; margin-bottom: 20px;">
                <img id="login-preview" src="" style="display:none; max-width:100px; margin: 0 auto;">
                <p id="upload-text">+ Upload Logo</p>
            </div>
            <input type="file" id="logo-upload" hidden accept="image/*" onchange="window.ui.handleLogo(this)">
            <h2>BrandOrb</h2>
            <input type="password" id="pass-input" placeholder="Access Key" style="width:100%; padding:10px; margin-bottom:10px;">
            <button onclick="window.ui.login()" style="width:100%; padding:10px; background:#0f172a; color:#38bdf8; border:none; border-radius:4px; cursor:pointer;">Secure Login</button>
        </div>
    </div>

    <div id="app-container">
        <aside id="sidebar">
            <div style="padding: 20px; text-align: center;">
                <div style="background:white; padding:10px; border-radius:8px; display:inline-block;">
                    <img id="sidebar-logo" src="" style="display:none; max-width:120px; height:auto;">
                </div>
            </div>
            <nav style="display:flex; flex-direction:column; padding:20px; gap:10px;">
                <button onclick="window.ui.showTab('MAP')" style="background:none; border:none; color:white; text-align:left; cursor:pointer;">Route Reports</button>
                <button onclick="window.ui.showTab('CLUSTER')" style="background:none; border:none; color:white; text-align:left; cursor:pointer;">Cluster Graphs</button>
            </nav>
        </aside>

        <main id="main-content">
            <header style="background:white; padding:20px 40px; display:flex; justify-content:space-between; align-items:center; border-bottom:1px solid #ddd;">
                <div><h1>BrandOrb</h1><p>Intelligence Dashboard</p></div>
                <div style="display:flex; gap:10px;">
                    <select id="client-filter"><option>General</option></select>
                    <button onclick="window.ui.openModal()" style="background:#0f172a; color:#38bdf8; border:none; padding:10px 20px; border-radius:6px; cursor:pointer;">+ Add Report</button>
                </div>
            </header>

            <div id="list-view" style="padding:40px;">
                <table style="width:100%; border-collapse:collapse; background:white; border-radius:8px; overflow:hidden; box-shadow:0 4px 6px rgba(0,0,0,0.05);">
                    <thead style="background:#f1f5f9; text-align:left;">
                        <tr><th style="padding:15px;">Report</th><th>Client</th><th>Type</th><th style="text-align:right; padding-right:15px;">Action</th></tr>
                    </thead>
                    <tbody id="report-rows"></tbody>
                </table>
            </div>

            <div id="viz-view" style="display:none; padding:20px;">
                <button onclick="window.ui.backToList()" style="padding:8px 15px; margin-bottom:10px;">‚Üê Back</button>
                <h2 id="viz-title"></h2>
                <div id="map-element"></div>
            </div>
        </main>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="ui-logic.js"></script>
    <script src="viz-logic.js"></script>
</body>
</html>
