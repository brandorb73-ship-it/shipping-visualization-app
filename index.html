<!DOCTYPE html>
<html>
<head>
    <title>Route Reports Pro</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="style.css">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
</head>
<body>
    <div id="sidebar">
        <div class="logo-section">
            <input type="file" id="logo-input" style="display:none" onchange="uploadLogo(event)">
            <img id="logo-img" src="https://via.placeholder.com/50" onclick="document.getElementById('logo-input').click()" title="Click to upload logo">
            <h3 id="logo-text">Company Name</h3>
        </div>
        <div class="menu">
            <div class="menu-item active" onclick="showSection('list')">ğŸ“ Route Reports</div>
            <div class="menu-item" onclick="showSection('list')">ğŸ“Š List Cluster Reports</div>
        </div>
    </div>

    <div id="main">
        <div id="top-bar">
            <h2>Route Reports</h2>
            <button class="add-btn" onclick="showSection('create')">+ Add New Route Report</button>
        </div>

        <div id="section-list" class="page">
            <div class="filters-bar">
                <input type="text" id="search" placeholder="Search report name...">
                <select id="client-filter"><option>All Clients</option></select>
                <button onclick="addClient()">+ New Client</button>
            </div>
            <table id="report-table">
                <thead><tr><th>Title</th><th>Date</th><th>Client</th><th>Type</th><th>Actions</th></tr></thead>
                <tbody id="list-body"></tbody>
            </table>
        </div>

        <div id="section-create" class="page" style="display:none">
            <div class="create-card">
                <h3>Create New Report</h3>
                <input type="text" id="new-title" placeholder="Report Title">
                <input type="text" id="new-url" placeholder="Google Sheet CSV URL">
                <div class="type-picker">
                    <button id="btn-map" class="selected" onclick="setType('map')">Map</button>
                    <button id="btn-cluster" onclick="setType('cluster')">Cluster Graph</button>
                </div>
                <button class="save-btn" onclick="saveToDrive()">Save & Publish</button>
            </div>
        </div>

        <div id="section-view" class="page" style="display:none">
            <div class="view-header">
                <button onclick="showSection('list')">â† Back</button>
                <h3 id="view-title">Viewing Map</h3>
                <div class="map-filters">
                    <select id="origin-country-filter" onchange="applyMapFilters()"><option value="All">All Origins</option></select>
                </div>
            </div>
            <div id="map"></div>
            <div id="cluster-container" style="display:none"></div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet-ant-path@1.1.2/dist/leaflet-ant-path.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
